@model Base_Project.Models.Member.IndexViewModel
@{ 
    Layout = null;
}
<script>
    $(function () {
        $("#SelectAll").click(function () {
            $("input[name=selectedItems]").prop("checked", $("#SelectAll").is(":checked"))
        })
        $("#Delete").click(function (e) {
            e.preventDefault()
            if ($("input[name=selectedItems]:checked").length == 0) {
                alert("請選擇至少一筆資料")
            }

            var selectItems = $('input:checkbox[name=selectedItems]:checked').map(function () { return $(this).val(); }).get();

            $.ajax({
                type: "POST",
                url: "@Url.Action("Delete")",
                data: "selectItems=" + selectItems.join(),
                success: function (data) {
                    if (data.Success) {
                        location.href = "@Url.Action("Index")"
                    }
                    var errorMsgs = data.ErrorMsgs
                    $(".error-utility").empty()
                    errorMsgs.forEach(function (error) {
                        $(".error-utility").append("<p>" + error.ErrorText + "<p>")
                    })
                },
                fail: function (ex) {
                    console.log(ex)
                }
            })
        })
        $("#Keyword").keyup(function () {
            getList()
        })
    })
    function getList(page = 1) {
        $("#PageIndex").val(page)
        var form = $("#Form").serialize()
        $.ajax({
            type: "POST",
            url: "@Url.Action("GetList")",
            data: form,
            success: function (html) {
                $("#PageListContainer").empty().append(html)
            },
            fail: function (ex) {
                console.log(ex)
            }
        })
    }
</script>
